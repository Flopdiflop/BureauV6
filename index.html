<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bureau des Missions - Village de Suna</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Noto+Sans+JP:wght@300;400;500;700&family=Sawarabi+Mincho&display=swap" rel="stylesheet">
    <style>
        :root {
            --sand-light: #f4e4c1;
            --sand-mid: #d4a574;
            --sand-dark: #b8860b;
            --desert-orange: #cc5500;
            --blood-red: #8b0000;
            --night-blue: #1a1a2e;
            --accent-gold: #ffd700;
            --shadow: rgba(0, 0, 0, 0.3);
            --success-green: #2d5016;
            --fail-red: #5c0a0a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, var(--sand-light) 0%, var(--sand-mid) 50%, var(--desert-orange) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 10 L60 30 L80 30 L65 42 L70 62 L50 50 L30 62 L35 42 L20 30 L40 30 Z' fill='rgba(139,0,0,0.03)' stroke='rgba(184,134,11,0.1)' stroke-width='0.5'/%3E%3C/svg%3E"),
                radial-gradient(circle at 20% 50%, rgba(204,85,0,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(139,0,0,0.08) 0%, transparent 50%),
                repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(184,134,11,0.02) 3px, rgba(184,134,11,0.02) 6px);
            background-size: 200px 200px, 100% 100%, 100% 100%, 20px 20px;
            background-position: 0 0, 0 0, 0 0, 0 0;
            pointer-events: none;
            z-index: 0;
            opacity: 0.6;
            animation: sandShift 60s linear infinite;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30,15 Q35,20 30,25 Q25,20 30,15 M15,30 Q20,35 15,40 Q10,35 15,30 M45,30 Q50,35 45,40 Q40,35 45,30' fill='none' stroke='rgba(139,0,0,0.04)' stroke-width='0.8'/%3E%3C/svg%3E");
            background-size: 120px 120px;
            pointer-events: none;
            z-index: 0;
            opacity: 0.3;
        }

        @keyframes sandShift {
            0% {
                background-position: 0 0, 0 0, 0 0, 0 0;
            }
            100% {
                background-position: 200px 200px, 0 0, 0 0, 20px 20px;
            }
        }

        .sand-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: var(--sand-dark);
            border-radius: 50%;
            opacity: 0.3;
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.3;
            }
            90% {
                opacity: 0.3;
            }
            100% {
                transform: translate(100px, 100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 2;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: slideDown 0.8s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .village-symbol {
            width: 120px;
            height: 120px;
            margin: 0 auto 1.5rem;
            background: linear-gradient(135deg, var(--desert-orange), var(--blood-red));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 40px var(--shadow),
                        inset 0 0 30px rgba(255, 215, 0, 0.2);
            position: relative;
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 10px 40px var(--shadow),
                            inset 0 0 30px rgba(255, 215, 0, 0.2);
            }
            50% {
                box-shadow: 0 10px 60px rgba(139, 0, 0, 0.5),
                            inset 0 0 50px rgba(255, 215, 0, 0.4);
            }
        }

        .village-symbol::before {
            content: 'Á†Ç';
            font-family: 'Cinzel', serif;
            font-size: 4rem;
            font-weight: 700;
            color: var(--sand-light);
            text-shadow: 2px 2px 10px rgba(0, 0, 0, 0.5);
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 3rem;
            font-weight: 700;
            color: var(--blood-red);
            text-shadow: 3px 3px 0 var(--sand-dark),
                         6px 6px 20px rgba(0, 0, 0, 0.3);
            margin-bottom: 0.5rem;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--night-blue);
            font-weight: 300;
            letter-spacing: 4px;
            text-transform: uppercase;
        }

        .tabs {
            display: flex;
            gap: 0;
            justify-content: center;
            margin-bottom: 2rem;
            animation: fadeIn 1s ease-out 0.2s both;
            border: 3px solid var(--desert-orange);
            border-radius: 15px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.1);
            box-shadow: 0 10px 30px var(--shadow);
        }

        .tab-btn {
            flex: 1;
            padding: 1.2rem 2rem;
            background: linear-gradient(135deg, var(--sand-light), var(--sand-mid));
            border: none;
            border-right: 2px solid var(--desert-orange);
            font-family: 'Cinzel', serif;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--night-blue);
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .tab-btn:last-child {
            border-right: none;
        }

        .tab-btn::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0;
            background: linear-gradient(135deg, var(--desert-orange), var(--blood-red));
            transition: height 0.4s ease;
            z-index: 0;
        }

        .tab-btn span {
            position: relative;
            z-index: 1;
        }

        .tab-btn:hover::before {
            height: 5px;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--desert-orange), var(--blood-red));
            color: white;
            box-shadow: inset 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .tab-btn.active::before {
            height: 100%;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        .filters {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 2rem;
            animation: fadeIn 1s ease-out 0.3s both;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .filter-btn {
            padding: 0.8rem 2rem;
            background: linear-gradient(135deg, var(--sand-light), var(--sand-mid));
            border: 2px solid var(--desert-orange);
            border-radius: 30px;
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 500;
            font-size: 1rem;
            color: var(--night-blue);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .filter-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--desert-orange);
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }

        .filter-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .filter-btn:hover {
            color: white;
            border-color: var(--blood-red);
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(139, 0, 0, 0.4);
        }

        .filter-btn span {
            position: relative;
            z-index: 1;
        }

        .filter-btn.active {
            background: linear-gradient(135deg, var(--desert-orange), var(--blood-red));
            color: white;
            border-color: var(--accent-gold);
            box-shadow: 0 6px 25px rgba(139, 0, 0, 0.5);
        }

        .missions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
            animation: fadeIn 1s ease-out 0.5s both;
        }

        .mission-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 10px 30px var(--shadow),
                        inset 0 0 50px rgba(184, 134, 11, 0.05);
            border: 3px solid var(--sand-dark);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }

        .mission-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.2), transparent);
            transition: left 0.5s;
        }

        .mission-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 80px;
            height: 80px;
            background: url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M40 10 L48 26 L66 26 L52 36 L58 52 L40 42 L22 52 L28 36 L14 26 L32 26 Z' fill='rgba(184,134,11,0.08)' stroke='rgba(139,0,0,0.1)' stroke-width='1'/%3E%3C/svg%3E") no-repeat;
            opacity: 0.3;
            pointer-events: none;
        }

        .participant-input {
            width: 100%;
            padding: 0.8rem;
            margin: 0.5rem 0;
            border: 2px solid var(--sand-dark);
            border-radius: 8px;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s;
        }

        .participant-input:focus {
            outline: none;
            border-color: var(--desert-orange);
            box-shadow: 0 0 15px rgba(204, 85, 0, 0.3);
        }

        .participants-list {
            margin: 1rem 0;
        }

        .participant-tag {
            display: inline-block;
            padding: 0.4rem 1rem;
            margin: 0.3rem;
            background: linear-gradient(135deg, var(--sand-mid), var(--sand-dark));
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .validation-section {
            margin-top: 1.5rem;
            padding: 1rem;
            background: rgba(244, 228, 193, 0.3);
            border-radius: 10px;
            border: 2px dashed var(--sand-dark);
        }

        .validation-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .validate-btn {
            flex: 1;
            padding: 0.8rem;
            border: none;
            border-radius: 10px;
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .validate-success {
            background: linear-gradient(135deg, #4CAF50, var(--success-green));
            color: white;
        }

        .validate-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .validate-fail {
            background: linear-gradient(135deg, #f44336, var(--fail-red));
            color: white;
        }

        .validate-fail:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.4);
        }

        .completed-badge {
            position: absolute;
            top: 1rem;
            left: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            z-index: 3;
        }

        .completed-badge.success {
            background: linear-gradient(135deg, #4CAF50, var(--success-green));
            color: white;
        }

        .completed-badge.failed {
            background: linear-gradient(135deg, #f44336, var(--fail-red));
            color: white;
        }

        .recap-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px var(--shadow),
                        inset 0 0 50px rgba(184, 134, 11, 0.05);
            border-left: 6px solid var(--desert-orange);
            position: relative;
            overflow: hidden;
        }

        .recap-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: url("data:image/svg+xml,%3Csvg width='150' height='150' viewBox='0 0 150 150' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M75 20 L90 50 L122 50 L97 68 L107 98 L75 80 L43 98 L53 68 L28 50 L60 50 Z' fill='none' stroke='rgba(184,134,11,0.1)' stroke-width='2'/%3E%3C/svg%3E") no-repeat;
            opacity: 0.3;
        }

        .recap-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .recap-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            color: var(--night-blue);
            font-weight: 600;
        }

        .recap-status {
            padding: 0.5rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
        }

        .ryo-symbol {
            font-family: 'Sawarabi Mincho', serif;
            font-weight: 700;
        }

        .besant {
            display: inline-block;
            width: 0.9em;
            height: 0.9em;
            background: radial-gradient(circle at 30% 30%, #ffd700, #b8860b);
            border-radius: 50%;
            border: 2px solid #b8860b;
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.4),
                        0 2px 4px rgba(0, 0, 0, 0.3);
            vertical-align: middle;
            margin: 0 0.2em;
        }

        .reward-input-group {
            margin: 1rem 0;
        }

        .reward-input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--night-blue);
        }

        .reward-input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid var(--sand-dark);
            border-radius: 8px;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s;
        }

        .reward-input:focus {
            outline: none;
            border-color: var(--desert-orange);
            box-shadow: 0 0 15px rgba(204, 85, 0, 0.3);
        }

        .reward-display {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(244, 228, 193, 0.3);
            border-radius: 8px;
            border: 2px solid var(--accent-gold);
        }

        .reward-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .reward-item:last-child {
            margin-bottom: 0;
        }

        .edit-reward-btn {
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, var(--sand-mid), var(--sand-dark));
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 0.5rem;
        }

        .edit-reward-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(184, 134, 11, 0.4);
        }

        .delete-mission-btn {
            padding: 0.7rem 1.5rem;
            background: rgba(220, 20, 60, 0.85);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 0, 0, 0.3);
            font-family: 'Noto Sans JP', sans-serif;
            opacity: 0.8;
        }

        .delete-mission-btn:hover {
            opacity: 1;
            background: rgba(139, 0, 0, 0.9);
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(139, 0, 0, 0.5);
        }

        .completed-badge {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            padding: 0.4rem 0.9rem;
            border-radius: 15px;
            font-weight: 600;
            font-size: 0.75rem;
            z-index: 3;
            opacity: 0.9;
        }

        .completed-badge.success {
            background: rgba(76, 175, 80, 0.85);
            color: white;
        }

        .completed-badge.failed {
            background: rgba(244, 67, 54, 0.85);
            color: white;
        }

        .add-mission-container {
            text-align: center;
            margin-bottom: 2rem;
        }

        .add-mission-btn {
            padding: 1rem 2.5rem;
            background: linear-gradient(135deg, var(--accent-gold), var(--sand-dark));
            color: var(--night-blue);
            border: 3px solid var(--desert-orange);
            border-radius: 15px;
            font-family: 'Cinzel', serif;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.4s;
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
        }

        .add-mission-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.6);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--night-blue);
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid var(--sand-dark);
            border-radius: 8px;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s;
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--desert-orange);
            box-shadow: 0 0 15px rgba(204, 85, 0, 0.3);
        }

        .recap-table-container {
            margin-top: 2rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px var(--shadow);
            border: 3px solid var(--desert-orange);
            overflow-x: auto;
        }

        .recap-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        .recap-table thead {
            background: linear-gradient(135deg, var(--desert-orange), var(--blood-red));
            color: white;
        }

        .recap-table th {
            padding: 1rem;
            text-align: left;
            font-family: 'Cinzel', serif;
            font-weight: 600;
            border-bottom: 3px solid var(--sand-dark);
        }

        .recap-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--sand-mid);
        }

        .recap-table tbody tr {
            transition: all 0.3s;
        }

        .recap-table tbody tr:hover {
            background: rgba(244, 228, 193, 0.3);
            transform: scale(1.01);
        }

        .recap-table .status-cell {
            font-weight: 600;
        }

        .recap-table .status-success {
            color: var(--success-green);
        }

        .recap-table .status-failed {
            color: var(--fail-red);
        }

        .recap-view-toggle {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .view-toggle-btn {
            padding: 0.8rem 1.5rem;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid var(--sand-dark);
            border-radius: 10px;
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .view-toggle-btn.active {
            background: linear-gradient(135deg, var(--desert-orange), var(--blood-red));
            color: white;
            border-color: var(--accent-gold);
        }

        .view-toggle-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .delete-recap-btn {
            padding: 0.4rem 0.8rem;
            background: rgba(220, 20, 60, 0.85);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 0.5rem;
            opacity: 0.8;
        }

        .delete-recap-btn:hover {
            opacity: 1;
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(220, 20, 60, 0.4);
        }

        .validator-input-group {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 8px;
            border: 2px solid var(--sand-mid);
        }

        .validator-input {
            width: 100%;
            padding: 0.6rem;
            border: 2px solid var(--sand-dark);
            border-radius: 6px;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s;
        }

        .validator-input:focus {
            outline: none;
            border-color: var(--accent-gold);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }

        .validator-display {
            font-size: 0.85rem;
            color: #666;
            font-style: italic;
            margin-top: 0.3rem;
        }

        .admin-panel {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
        }

        .admin-login-btn {
            padding: 0.7rem 1.5rem;
            background: linear-gradient(135deg, var(--night-blue), var(--blood-red));
            color: white;
            border: 2px solid var(--accent-gold);
            border-radius: 10px;
            font-family: 'Cinzel', serif;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .admin-login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
        }

        .admin-status {
            padding: 0.7rem 1.5rem;
            background: linear-gradient(135deg, var(--success-green), #1a5c0a);
            color: white;
            border: 2px solid var(--accent-gold);
            border-radius: 10px;
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-logout-btn {
            background: rgba(220, 20, 60, 0.9);
            color: white;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .admin-logout-btn:hover {
            background: rgba(139, 0, 0, 1);
            transform: scale(1.05);
        }

        .admin-login-form {
            background: rgba(255, 255, 255, 0.98);
            padding: 2rem;
            border-radius: 15px;
            border: 3px solid var(--desert-orange);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            min-width: 300px;
        }

        .admin-form-title {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            color: var(--blood-red);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .admin-form-group {
            margin-bottom: 1rem;
        }

        .admin-form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--night-blue);
        }

        .admin-form-input {
            width: 100%;
            padding: 0.7rem;
            border: 2px solid var(--sand-dark);
            border-radius: 8px;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.95rem;
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s;
        }

        .admin-form-input:focus {
            outline: none;
            border-color: var(--desert-orange);
            box-shadow: 0 0 15px rgba(204, 85, 0, 0.3);
        }

        .admin-form-error {
            color: var(--blood-red);
            font-size: 0.85rem;
            margin-top: 0.5rem;
            text-align: center;
        }

        .admin-submit-btn {
            width: 100%;
            padding: 0.9rem;
            background: linear-gradient(135deg, var(--desert-orange), var(--blood-red));
            color: white;
            border: none;
            border-radius: 10px;
            font-family: 'Cinzel', serif;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 1rem;
        }

        .admin-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 0, 0, 0.4);
        }

        .admin-mode-indicator {
            position: fixed;
            top: 5rem;
            right: 1rem;
            background: rgba(45, 80, 22, 0.95);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 999;
        }

        .mission-card:hover::before {
            left: 100%;
        }

        .mission-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 50px rgba(139, 0, 0, 0.3);
            border-color: var(--desert-orange);
        }

        .rank-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 2;
        }

        .rank-badge::before {
            content: 'Á†Ç';
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            position: absolute;
            opacity: 0.3;
        }

        .rank-badge::after {
            content: attr(data-rank);
            font-size: 1.5rem;
            font-weight: 700;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 1;
        }

        .rank-E { background: linear-gradient(135deg, #8b8b8b, #5a5a5a); }
        .rank-D { background: linear-gradient(135deg, #8b4513, #654321); }
        .rank-C { background: linear-gradient(135deg, #4682b4, #1e3a5f); }
        .rank-B { background: linear-gradient(135deg, #32cd32, #228b22); }
        .rank-A { background: linear-gradient(135deg, #ff8c00, #cc5500); }
        .rank-S { background: linear-gradient(135deg, #dc143c, #8b0000); }

        .mission-title {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--night-blue);
            margin-bottom: 1rem;
            padding-right: 70px;
        }

        .mission-type {
            display: inline-block;
            padding: 0.4rem 1rem;
            background: var(--sand-mid);
            color: var(--night-blue);
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 1rem;
            border: 1px solid var(--desert-orange);
        }

        .mission-description {
            color: #333;
            line-height: 1.6;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .mission-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 2px solid var(--sand-mid);
        }

        .mission-reward {
            font-weight: 700;
            color: var(--accent-gold);
            font-size: 1.2rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .mission-duration {
            color: #666;
            font-size: 0.9rem;
        }

        .accept-btn {
            padding: 0.7rem 1.5rem;
            background: linear-gradient(135deg, var(--desert-orange), var(--blood-red));
            color: white;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 0, 0, 0.3);
            font-family: 'Noto Sans JP', sans-serif;
        }

        .accept-btn:hover {
            background: linear-gradient(135deg, var(--blood-red), var(--night-blue));
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(139, 0, 0, 0.5);
        }

        .stats-bar {
            display: flex;
            gap: 2rem;
            justify-content: center;
            margin: 2rem 0;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            border: 2px solid var(--desert-orange);
            box-shadow: 0 10px 30px var(--shadow);
            animation: fadeIn 1s ease-out 0.7s both;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--blood-red);
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
        }

        .stat-label {
            color: var(--night-blue);
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 1px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease-out;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, var(--sand-light), white);
            padding: 2.5rem;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 4px solid var(--desert-orange);
            position: relative;
            animation: scaleIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 2rem;
            cursor: pointer;
            color: var(--blood-red);
            transition: transform 0.3s;
        }

        .modal-close:hover {
            transform: rotate(90deg);
        }

        .modal-title {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: var(--blood-red);
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .missions-grid {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="sand-particles" id="sandParticles"></div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <button class="admin-login-btn" onclick="showAdminLogin()">üîí Admin</button>
    </div>

    <div class="container">
        <header>
            <h1>Bureau des Missions</h1>
            <p class="subtitle">Village Cach√© de Sunagakure</p>
        </header>

        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="totalMissions">0</div>
                <div class="stat-label">Missions Disponibles</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="completedMissions">0</div>
                <div class="stat-label">Missions Compl√©t√©es</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-btn active" data-tab="available"><span>Missions Disponibles</span></button>
            <button class="tab-btn" data-tab="recap"><span>R√©capitulatif</span></button>
            <button class="tab-btn" id="validationTab" data-tab="validation" style="display: none;"><span>Validation</span></button>
        </div>

        <!-- TAB: Available Missions -->
        <div class="tab-content active" id="tab-available">
            <div class="add-mission-container" id="addMissionContainer" style="display: none;">
                <button class="add-mission-btn" onclick="showAddMissionModal()">
                    ‚ûï Cr√©er une Nouvelle Mission
                </button>
            </div>

            <div class="filters">
                <button class="filter-btn active" data-filter="all"><span>Toutes</span></button>
                <button class="filter-btn" data-filter="E"><span>Rang E</span></button>
                <button class="filter-btn" data-filter="D"><span>Rang D</span></button>
                <button class="filter-btn" data-filter="C"><span>Rang C</span></button>
                <button class="filter-btn" data-filter="B"><span>Rang B</span></button>
                <button class="filter-btn" data-filter="A"><span>Rang A</span></button>
                <button class="filter-btn" data-filter="S"><span>Rang S</span></button>
            </div>

            <div class="missions-grid" id="missionsGrid"></div>
        </div>

        <!-- TAB: Recap -->
        <div class="tab-content" id="tab-recap">
            <div class="recap-view-toggle">
                <button class="view-toggle-btn active" onclick="toggleRecapView('cards')">Vue Cartes</button>
                <button class="view-toggle-btn" onclick="toggleRecapView('table')">Vue Tableau</button>
            </div>
            <div id="recapCardsView"></div>
            <div id="recapTableView" style="display: none;"></div>
        </div>

        <!-- TAB: Validation -->
        <div class="tab-content" id="tab-validation">
            <div id="validationContent"></div>
        </div>
    </div>

    <div class="modal" id="missionModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <h2 class="modal-title" id="modalTitle"></h2>
            <div id="modalBody"></div>
        </div>
    </div>

    <div class="modal" id="adminModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeAdminModal()">&times;</span>
            <div class="admin-login-form">
                <h2 class="admin-form-title">Connexion Admin</h2>
                <div class="admin-form-group">
                    <label>ID de connexion:</label>
                    <input type="text" id="adminId" class="admin-form-input" placeholder="Entrez votre ID">
                </div>
                <div class="admin-form-group">
                    <label>Mot de passe:</label>
                    <input type="password" id="adminPassword" class="admin-form-input" placeholder="Entrez votre mot de passe">
                </div>
                <div id="adminError" class="admin-form-error"></div>
                <button class="admin-submit-btn" onclick="attemptAdminLogin()">Se connecter</button>
            </div>
        </div>
    </div>

    <script>
        // Admin credentials
        const ADMIN_CREDENTIALS = {
            id: '974301234',
            password: 'Sunagakure'
        };

        // Admin state
        let isAdminLoggedIn = false;

        // Check admin login on page load
        function checkAdminLogin() {
            const adminSession = sessionStorage.getItem('suna_admin_logged_in');
            if (adminSession === 'true') {
                isAdminLoggedIn = true;
                updateAdminUI();
            }
        }

        // Show admin login modal
        function showAdminLogin() {
            const modal = document.getElementById('adminModal');
            modal.classList.add('active');
            document.getElementById('adminError').textContent = '';
            document.getElementById('adminId').value = '';
            document.getElementById('adminPassword').value = '';
        }

        // Close admin modal
        function closeAdminModal() {
            const modal = document.getElementById('adminModal');
            modal.classList.remove('active');
        }

        // Attempt admin login
        function attemptAdminLogin() {
            const enteredId = document.getElementById('adminId').value.trim();
            const enteredPassword = document.getElementById('adminPassword').value;
            const errorDiv = document.getElementById('adminError');

            if (enteredId === ADMIN_CREDENTIALS.id && enteredPassword === ADMIN_CREDENTIALS.password) {
                isAdminLoggedIn = true;
                sessionStorage.setItem('suna_admin_logged_in', 'true');
                closeAdminModal();
                updateAdminUI();
                alert('‚úì Connexion admin r√©ussie!\n\nVous pouvez maintenant cr√©er, modifier et supprimer des missions.');
            } else {
                errorDiv.textContent = '‚ùå ID ou mot de passe incorrect';
                // Clear after 3 seconds
                setTimeout(() => {
                    errorDiv.textContent = '';
                }, 3000);
            }
        }

        // Admin logout
        function adminLogout() {
            if (confirm('Se d√©connecter du mode administrateur?')) {
                isAdminLoggedIn = false;
                sessionStorage.removeItem('suna_admin_logged_in');
                updateAdminUI();
                alert('D√©connexion r√©ussie.');
            }
        }

        // Update admin UI
        function updateAdminUI() {
            const adminPanel = document.getElementById('adminPanel');
            const validationTab = document.getElementById('validationTab');
            
            if (isAdminLoggedIn) {
                adminPanel.innerHTML = `
                    <div class="admin-status">
                        <span>üë§ Admin</span>
                        <button class="admin-logout-btn" onclick="adminLogout()">D√©connexion</button>
                    </div>
                `;
                
                // Show validation tab
                if (validationTab) {
                    validationTab.style.display = 'block';
                }
                
                // Add admin mode indicator
                if (!document.getElementById('adminIndicator')) {
                    const indicator = document.createElement('div');
                    indicator.id = 'adminIndicator';
                    indicator.className = 'admin-mode-indicator';
                    indicator.textContent = 'üîì Mode Administrateur';
                    document.body.appendChild(indicator);
                }
            } else {
                adminPanel.innerHTML = `
                    <button class="admin-login-btn" onclick="showAdminLogin()">üîí Admin</button>
                `;
                
                // Hide validation tab
                if (validationTab) {
                    validationTab.style.display = 'none';
                }
                
                // Remove admin mode indicator
                const indicator = document.getElementById('adminIndicator');
                if (indicator) {
                    indicator.remove();
                }
            }
            
            // Re-render missions to show/hide admin buttons
            renderMissions('all');
        }

        // Storage keys
        const STORAGE_KEYS = {
            MISSIONS: 'suna_missions',
            ACTIVE_MISSIONS: 'suna_active_missions',
            COMPLETED_MISSIONS: 'suna_completed_missions',
            NEXT_ID: 'suna_next_mission_id'
        };

        // Load data from localStorage
        function loadData(key) {
            const data = localStorage.getItem(key);
            return data ? JSON.parse(data) : null;
        }

        // Save data to localStorage
        function saveData(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }

        // Get next mission ID
        function getNextMissionId() {
            let nextId = parseInt(localStorage.getItem(STORAGE_KEYS.NEXT_ID)) || 17;
            localStorage.setItem(STORAGE_KEYS.NEXT_ID, nextId + 1);
            return nextId;
        }

        // Default missions
        const defaultMissions = [
            {
                id: 1,
                title: "Nettoyage des Dunes Est",
                rank: "E",
                type: "Nettoyage",
                description: "Les r√©centes temp√™tes de sable ont laiss√© des d√©bris dans les dunes est du village. Nettoyez la zone.",
                reward: 500,
                resources: "",
                duration: "1-2h",
                details: "Mission simple pour les genin d√©butants. Apportez vos propres outils de nettoyage."
            },
            {
                id: 2,
                title: "Surveillance du March√©",
                rank: "D",
                type: "Surveillance",
                description: "Surveillez le march√© principal pendant 6 heures pour d√©tecter toute activit√© suspecte.",
                reward: 1200,
                resources: "",
                duration: "6h",
                details: "Restez discret et signalez imm√©diatement toute anomalie au bureau des missions."
            },
            {
                id: 3,
                title: "Filature de Suspect",
                rank: "C",
                type: "Filature",
                description: "Un marchand suspect a √©t√© rep√©r√© pr√®s des fronti√®res. Suivez-le discr√®tement et rapportez ses activit√©s.",
                reward: 3500,
                resources: "",
                duration: "1-2 jours",
                details: "Comp√©tences en discr√©tion requises. Ne vous faites pas rep√©rer sous peine d'√©chec de mission."
            },
            {
                id: 4,
                title: "R√©cup√©ration d'Artefact Ancien",
                rank: "B",
                type: "R√©cup√©ration",
                description: "Un artefact du clan Shirogame a √©t√© vol√©. Infiltrez le repaire des bandits et r√©cup√©rez-le.",
                reward: 8000,
                resources: "",
                duration: "3-5 jours",
                details: "Mission dangereuse. Combat probable. √âquipe de 3 ninjas recommand√©e."
            },
            {
                id: 5,
                title: "Entra√Ænement des Recrues",
                rank: "D",
                type: "Entra√Ænement",
                description: "Formez les nouvelles recrues de l'acad√©mie aux techniques de base du Taijutsu.",
                reward: 1500,
                resources: "",
                duration: "4h",
                details: "Patience et p√©dagogie requises. Les recrues ont entre 8 et 12 ans."
            },
            {
                id: 6,
                title: "Escorte de Diplomate",
                rank: "A",
                type: "Escorte",
                description: "Escortez le diplomate du Kazekage jusqu'au Village de la Feuille √† travers le d√©sert hostile.",
                reward: 15000,
                resources: "",
                duration: "7-10 jours",
                details: "Menaces de ninjas ren√©gats confirm√©es. Niveau J√¥nin requis."
            },
            {
                id: 7,
                title: "√âlimination de D√©serteurs Rang S",
                rank: "S",
                type: "√âlimination",
                description: "Trois d√©serteurs de rang A ont form√© une alliance et menacent les routes commerciales. √âliminez-les.",
                reward: 50000,
                resources: "",
                duration: "2-3 semaines",
                details: "EXTR√äMEMENT DANGEREUX. √âquipe d'√©lite uniquement. Autorisation du Kazekage requise."
            },
            {
                id: 8,
                title: "R√©paration de l'Aqueduc",
                rank: "E",
                type: "R√©paration",
                description: "L'aqueduc du quartier sud n√©cessite des r√©parations mineures. Aidez les artisans locaux.",
                reward: 600,
                resources: "",
                duration: "3h",
                details: "Aucune comp√©tence particuli√®re requise. Travail physique."
            },
            {
                id: 9,
                title: "Surveillance Nocturne des Remparts",
                rank: "C",
                type: "Surveillance",
                description: "Assurez la surveillance nocturne des remparts nord pendant une semaine.",
                reward: 4000,
                resources: "",
                duration: "7 nuits",
                details: "Travail de nuit. Vigilance constante requise. Rotation toutes les 4 heures."
            },
            {
                id: 10,
                title: "R√©cup√©ration de Parchemins Vol√©s",
                rank: "B",
                type: "R√©cup√©ration",
                description: "Des parchemins jutsu ont √©t√© vol√©s dans les archives. Traquez les voleurs et r√©cup√©rez les documents.",
                reward: 9500,
                resources: "",
                duration: "4-7 jours",
                details: "Les voleurs sont probablement des ninjas entra√Æn√©s. Discr√©tion et combat requis."
            },
            {
                id: 11,
                title: "Entra√Ænement Technique Avanc√©",
                rank: "C",
                type: "Entra√Ænement",
                description: "Participez √† une session d'entra√Ænement intensive sur les techniques de marionnettes avec un ma√Ætre.",
                reward: 3000,
                resources: "",
                duration: "2 jours",
                details: "Am√©lioration garantie des comp√©tences. Membres du clan Shirogame prioritaires."
            },
            {
                id: 12,
                title: "Infiltration Base Ennemie",
                rank: "A",
                type: "Infiltration",
                description: "Infiltrez une base ennemie suspect√©e d'abriter des informations sur une attaque imminente.",
                reward: 18000,
                resources: "",
                duration: "1-2 semaines",
                details: "Mission d'espionnage de haut niveau. Risque de mort √©lev√©. Extraction non garantie."
            },
            {
                id: 13,
                title: "Livraison de Courrier Urgent",
                rank: "D",
                type: "Livraison",
                description: "Livrez un courrier urgent et confidentiel au poste avanc√© du d√©sert occidental.",
                reward: 1800,
                resources: "",
                duration: "1 jour",
                details: "Rapidit√© essentielle. Ne lisez pas le contenu sous peine de sanctions."
            },
            {
                id: 14,
                title: "Chasse au Bij√ª Mineur",
                rank: "S",
                type: "Chasse",
                description: "Un bij√ª mineur terrorise les villages voisins. Neutralisez ou capturez la cr√©ature.",
                reward: 75000,
                resources: "",
                duration: "1 mois",
                details: "MISSION SUICIDE POTENTIELLE. √âquipe de 5+ ninjas d'√©lite requise. Testament recommand√©."
            },
            {
                id: 15,
                title: "Aide √† la R√©colte",
                rank: "E",
                type: "Aide Civile",
                description: "Les fermiers du sud ont besoin d'aide pour la r√©colte annuelle d'oasis.",
                reward: 700,
                resources: "",
                duration: "1 jour",
                details: "Travail agricole simple. Bon pour l'image du village aupr√®s des civils."
            },
            {
                id: 16,
                title: "Filature d'Espion Ennemi",
                rank: "A",
                type: "Filature",
                description: "Un espion ennemi a √©t√© identifi√© dans le village. Suivez-le pour d√©couvrir son r√©seau.",
                reward: 16000,
                resources: "",
                duration: "5-10 jours",
                details: "Ne pas engager le combat. Observer et rapporter uniquement. Ma√Ætrise du Genjutsu utile."
            }
        ];

        // Initialize missions from localStorage or use defaults
        let missions = loadData(STORAGE_KEYS.MISSIONS);
        if (!missions || missions.length === 0) {
            missions = [...defaultMissions];
            saveData(STORAGE_KEYS.MISSIONS, missions);
        }

        let activeMissions = loadData(STORAGE_KEYS.ACTIVE_MISSIONS) || [];
        let completedMissions = loadData(STORAGE_KEYS.COMPLETED_MISSIONS) || [];

        let currentRecapView = 'cards'; // 'cards' or 'table'

        // Toggle recap view
        function toggleRecapView(view) {
            currentRecapView = view;
            const cardsView = document.getElementById('recapCardsView');
            const tableView = document.getElementById('recapTableView');
            const buttons = document.querySelectorAll('.view-toggle-btn');
            
            buttons.forEach(btn => {
                if ((view === 'cards' && btn.textContent.includes('Cartes')) ||
                    (view === 'table' && btn.textContent.includes('Tableau'))) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            if (view === 'cards') {
                cardsView.style.display = 'block';
                tableView.style.display = 'none';
                renderRecapCards();
            } else {
                cardsView.style.display = 'none';
                tableView.style.display = 'block';
                renderRecapTable();
            }
        }

        // Show add mission modal
        function showAddMissionModal() {
            if (!isAdminLoggedIn) {
                alert('‚ö†Ô∏è Acc√®s refus√©. Connexion administrateur requise.');
                return;
            }
            
            const modal = document.getElementById('missionModal');
            document.getElementById('modalTitle').textContent = 'Cr√©er une Nouvelle Mission';
            document.getElementById('modalBody').innerHTML = `
                <div style="margin: 1.5rem 0;">
                    <div class="form-group">
                        <label>Titre de la mission:</label>
                        <input type="text" id="newMissionTitle" class="form-input" placeholder="Ex: Escorte de caravane">
                    </div>
                    
                    <div class="form-group">
                        <label>Rang:</label>
                        <select id="newMissionRank" class="form-select">
                            <option value="E">E - Genin d√©butant</option>
                            <option value="D">D - Genin</option>
                            <option value="C" selected>C - Ch√ªnin</option>
                            <option value="B">B - Ch√ªnin exp√©riment√©</option>
                            <option value="A">A - J√¥nin</option>
                            <option value="S">S - √âlite</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Type:</label>
                        <input type="text" id="newMissionType" class="form-input" placeholder="Ex: Escorte, Surveillance, Combat...">
                    </div>
                    
                    <div class="form-group">
                        <label>Description courte:</label>
                        <textarea id="newMissionDescription" class="form-textarea" placeholder="Description visible sur la carte de mission"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>D√©tails complets:</label>
                        <textarea id="newMissionDetails" class="form-textarea" placeholder="D√©tails complets de la mission"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>R√©compense en Besants:</label>
                        <input type="number" id="newMissionReward" class="form-input" value="0" min="0" placeholder="0">
                    </div>
                    
                    <div class="form-group">
                        <label>Ressources offertes:</label>
                        <input type="text" id="newMissionResources" class="form-input" placeholder="Ex: 2x Kunai, 1x Parchemin">
                    </div>
                    
                    <div class="form-group">
                        <label>Dur√©e estim√©e:</label>
                        <input type="text" id="newMissionDuration" class="form-input" placeholder="Ex: 2-3 jours">
                    </div>
                    
                    <button class="accept-btn" style="width: 100%; margin-top: 1rem; padding: 1rem;" onclick="createNewMission()">
                        Cr√©er la Mission
                    </button>
                </div>
            `;
            modal.classList.add('active');
        }

        // Create new mission
        function createNewMission() {
            const title = document.getElementById('newMissionTitle').value.trim();
            const rank = document.getElementById('newMissionRank').value;
            const type = document.getElementById('newMissionType').value.trim();
            const description = document.getElementById('newMissionDescription').value.trim();
            const details = document.getElementById('newMissionDetails').value.trim();
            const reward = parseInt(document.getElementById('newMissionReward').value) || 0;
            const resources = document.getElementById('newMissionResources').value.trim();
            const duration = document.getElementById('newMissionDuration').value.trim();
            
            if (!title || !type || !description || !details || !duration) {
                alert('Veuillez remplir tous les champs obligatoires!');
                return;
            }
            
            const newMission = {
                id: getNextMissionId(),
                title,
                rank,
                type,
                description,
                details,
                reward,
                resources,
                duration
            };
            
            missions.push(newMission);
            saveData(STORAGE_KEYS.MISSIONS, missions);
            
            closeModal();
            renderMissions('all');
            
            alert(`‚úì Mission "${title}" cr√©√©e avec succ√®s!`);
        }

        // Delete mission
        function deleteMission(id) {
            if (!isAdminLoggedIn) {
                alert('‚ö†Ô∏è Acc√®s refus√©. Connexion administrateur requise.');
                return;
            }
            
            const mission = missions.find(m => m.id === id);
            if (!mission) return;
            
            if (!confirm(`√ätes-vous s√ªr de vouloir supprimer la mission "${mission.title}"?\n\nCette action est irr√©versible.`)) {
                return;
            }
            
            missions = missions.filter(m => m.id !== id);
            saveData(STORAGE_KEYS.MISSIONS, missions);
            renderMissions('all');
            
            alert(`Mission "${mission.title}" supprim√©e.`);
        }

        // Edit mission reward
        function editMissionReward(id) {
            if (!isAdminLoggedIn) {
                alert('‚ö†Ô∏è Acc√®s refus√©. Connexion administrateur requise.');
                return;
            }
            
            const mission = missions.find(m => m.id === id);
            if (!mission) return;
            
            const modal = document.getElementById('missionModal');
            document.getElementById('modalTitle').textContent = 'Modifier les R√©compenses';
            document.getElementById('modalBody').innerHTML = `
                <div style="margin: 1.5rem 0;">
                    <h3 style="margin-bottom: 1rem; color: var(--night-blue);">${mission.title}</h3>
                    
                    <div class="form-group">
                        <label>R√©compense en Besants:</label>
                        <input type="number" id="editReward" class="form-input" value="${mission.reward || 0}" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label>Ressources offertes:</label>
                        <input type="text" id="editResources" class="form-input" value="${mission.resources || ''}" placeholder="Ex: 3x Parchemins, 2x Kunai">
                    </div>
                    
                    <button class="accept-btn" style="width: 100%; margin-top: 1rem; padding: 1rem;" onclick="saveEditedReward(${id})">
                        Sauvegarder
                    </button>
                </div>
            `;
            modal.classList.add('active');
        }

        // Save edited reward
        function saveEditedReward(id) {
            const mission = missions.find(m => m.id === id);
            if (!mission) return;
            
            mission.reward = parseInt(document.getElementById('editReward').value) || 0;
            mission.resources = document.getElementById('editResources').value.trim();
            
            saveData(STORAGE_KEYS.MISSIONS, missions);
            closeModal();
            renderMissions('all');
            
            alert('R√©compenses mises √† jour!');
        }

        // Initialize
        function init() {
            checkAdminLogin();
            createSandParticles();
            renderMissions('all');
            updateStats();
            setupFilters();
            setupTabs();
            renderRecap();
            renderValidation();
        }

        // Create sand particle animation
        function createSandParticles() {
            const container = document.getElementById('sandParticles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        // Setup tabs
        function setupTabs() {
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetTab = btn.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and contents
                    tabBtns.forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab and its content
                    btn.classList.add('active');
                    document.getElementById('tab-' + targetTab).classList.add('active');
                    
                    // Refresh content if needed
                    if (targetTab === 'recap') {
                        renderRecap();
                    } else if (targetTab === 'validation') {
                        renderValidation();
                    } else if (targetTab === 'available') {
                        renderMissions('all');
                    }
                });
            });
        }

        // Render available missions
        function renderMissions(filter) {
            const grid = document.getElementById('missionsGrid');
            grid.innerHTML = '';

            // Show/hide add mission button based on admin status
            const addMissionContainer = document.getElementById('addMissionContainer');
            if (addMissionContainer) {
                addMissionContainer.style.display = isAdminLoggedIn ? 'block' : 'none';
            }

            // Filter out missions that are active or completed
            const activeMissionIds = activeMissions.map(m => m.id);
            const completedMissionIds = completedMissions.map(m => m.id);
            const unavailableIds = [...activeMissionIds, ...completedMissionIds];

            const availableMissions = missions.filter(m => !unavailableIds.includes(m.id));
            
            const filteredMissions = filter === 'all' 
                ? availableMissions 
                : availableMissions.filter(m => m.rank === filter);

            if (filteredMissions.length === 0) {
                grid.innerHTML = '<p style="text-align: center; color: var(--night-blue); font-size: 1.2rem; grid-column: 1/-1;">Aucune mission disponible dans cette cat√©gorie.</p>';
                return;
            }

            filteredMissions.forEach((mission, index) => {
                const card = document.createElement('div');
                card.className = 'mission-card';
                card.style.animationDelay = (index * 0.1) + 's';
                
                const rewardDisplay = mission.reward ? `<div class="mission-reward">${mission.reward.toLocaleString()} <span class="besant"></span></div>` : '';
                const resourcesDisplay = mission.resources ? `<div class="mission-duration">üì¶ ${mission.resources}</div>` : '';
                
                // Admin buttons (only show if logged in)
                const editRewardBtn = isAdminLoggedIn ? `
                    <button class="edit-reward-btn" onclick="event.stopPropagation(); editMissionReward(${mission.id})">
                        ‚úèÔ∏è Modifier r√©compenses
                    </button>
                ` : '';
                
                const deleteBtn = isAdminLoggedIn ? `
                    <button class="delete-mission-btn" onclick="event.stopPropagation(); deleteMission(${mission.id})">
                        üóëÔ∏è
                    </button>
                ` : '';
                
                card.innerHTML = `
                    <div class="rank-badge rank-${mission.rank}" data-rank="${mission.rank}"></div>
                    <h3 class="mission-title">${mission.title}</h3>
                    <span class="mission-type">${mission.type}</span>
                    <p class="mission-description">${mission.description}</p>
                    ${editRewardBtn}
                    <div class="mission-details">
                        <div>
                            ${rewardDisplay}
                            ${resourcesDisplay}
                            <div class="mission-duration">‚è± ${mission.duration}</div>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="accept-btn" onclick="event.stopPropagation(); acceptMission(${mission.id})">
                                Accepter
                            </button>
                            ${deleteBtn}
                        </div>
                    </div>
                `;
                card.onclick = (e) => {
                    if (!e.target.classList.contains('accept-btn') && 
                        !e.target.classList.contains('delete-mission-btn') &&
                        !e.target.classList.contains('edit-reward-btn')) {
                        showMissionDetails(mission);
                    }
                };
                grid.appendChild(card);
            });

            updateStats();
        }

        // Setup filter buttons
        function setupFilters() {
            const filterBtns = document.querySelectorAll('.filter-btn');
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    const filter = btn.getAttribute('data-filter');
                    renderMissions(filter);
                });
            });
        }

        // Update statistics
        function updateStats() {
            const activeMissionIds = activeMissions.map(m => m.id);
            const completedMissionIds = completedMissions.map(m => m.id);
            const unavailableIds = [...activeMissionIds, ...completedMissionIds];
            const availableCount = missions.filter(m => !unavailableIds.includes(m.id)).length;

            document.getElementById('totalMissions').textContent = availableCount;
            document.getElementById('completedMissions').textContent = completedMissions.length;
        }

        // Accept mission
        function acceptMission(id) {
            const mission = missions.find(m => m.id === id);
            if (!mission) return;

            const modal = document.getElementById('missionModal');
            document.getElementById('modalTitle').textContent = 'Accepter la Mission';
            document.getElementById('modalBody').innerHTML = `
                <div style="margin: 1.5rem 0;">
                    <h3 style="margin-bottom: 1rem; color: var(--night-blue);">${mission.title}</h3>
                    <p style="margin-bottom: 1rem;"><strong>Rang:</strong> ${mission.rank}</p>
                    <p style="margin-bottom: 1rem;"><strong>Dur√©e:</strong> ${mission.duration}</p>
                    
                    <div class="reward-input-group">
                        <label>R√©compense en Besants (optionnel):</label>
                        <input type="number" id="rewardInput" class="reward-input" 
                               value="${mission.reward || 0}" min="0" placeholder="Ex: 5000">
                    </div>
                    
                    <div class="reward-input-group">
                        <label>Ressources offertes (optionnel):</label>
                        <input type="text" id="resourcesInput" class="reward-input" 
                               value="${mission.resources || ''}" placeholder="Ex: 3x Parchemins de Feu, 2x Kunai">
                    </div>
                    
                    <div class="reward-input-group">
                        <label>Nom des participants (s√©parez par des virgules):</label>
                        <input type="text" id="participantsInput" class="participant-input" 
                               placeholder="Ex: Saturne, Kaede, Tensho">
                    </div>
                    
                    <button class="accept-btn" style="width: 100%; margin-top: 1.5rem; padding: 1rem;" 
                            onclick="confirmAcceptMission(${mission.id})">
                        Confirmer l'Acceptation
                    </button>
                </div>
            `;
            modal.classList.add('active');
        }

        // Confirm accept mission
        function confirmAcceptMission(id) {
            const participantsInput = document.getElementById('participantsInput').value.trim();
            const rewardInput = parseInt(document.getElementById('rewardInput').value) || 0;
            const resourcesInput = document.getElementById('resourcesInput').value.trim();
            
            if (!participantsInput) {
                alert('Veuillez entrer au moins un participant!');
                return;
            }

            const participants = participantsInput.split(',').map(p => p.trim()).filter(p => p);
            
            if (participants.length === 0) {
                alert('Veuillez entrer des noms de participants valides!');
                return;
            }

            const mission = missions.find(m => m.id === id);
            
            // Create mission with custom rewards
            const customMission = {
                ...mission,
                reward: rewardInput,
                resources: resourcesInput
            };
            
            activeMissions.push({
                id: mission.id,
                mission: customMission,
                participants: participants,
                acceptedDate: new Date().toISOString()
            });
            
            saveData(STORAGE_KEYS.ACTIVE_MISSIONS, activeMissions);
            
            closeModal();
            renderMissions('all');
            renderValidation();
            
            let rewardText = '';
            if (rewardInput > 0) rewardText += `${rewardInput.toLocaleString()} Besants`;
            if (resourcesInput) {
                if (rewardText) rewardText += ' + ';
                rewardText += resourcesInput;
            }
            if (!rewardText) rewardText = 'Aucune r√©compense';
            
            alert(`‚úì Mission accept√©e!\n\n"${mission.title}"\n\nParticipants: ${participants.join(', ')}\nR√©compense: ${rewardText}\n\nBonne chance, ninjas de Suna!`);
        }

        // Render validation tab
        function renderValidation() {
            const container = document.getElementById('validationContent');
            
            if (activeMissions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--night-blue);">
                        <h2 style="font-family: 'Cinzel', serif; margin-bottom: 1rem;">Aucune Mission Active</h2>
                        <p>Acceptez des missions pour pouvoir les valider ici.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = '';
            
            activeMissions.forEach(activeMission => {
                const card = document.createElement('div');
                card.className = 'mission-card';
                
                let rewardDisplay = '';
                if (activeMission.mission.reward > 0 || activeMission.mission.resources) {
                    rewardDisplay = '<div class="reward-display"><strong>R√©compenses:</strong><br>';
                    if (activeMission.mission.reward > 0) {
                        rewardDisplay += `<div class="reward-item">${activeMission.mission.reward.toLocaleString()} <span class="besant"></span></div>`;
                    }
                    if (activeMission.mission.resources) {
                        rewardDisplay += `<div class="reward-item">üì¶ ${activeMission.mission.resources}</div>`;
                    }
                    rewardDisplay += '</div>';
                }
                
                card.innerHTML = `
                    <div class="rank-badge rank-${activeMission.mission.rank}" data-rank="${activeMission.mission.rank}"></div>
                    <h3 class="mission-title">${activeMission.mission.title}</h3>
                    <span class="mission-type">${activeMission.mission.type}</span>
                    <p class="mission-description">${activeMission.mission.description}</p>
                    
                    <div class="participants-list">
                        <strong>Participants:</strong><br>
                        ${activeMission.participants.map(p => `<span class="participant-tag">${p}</span>`).join('')}
                    </div>
                    
                    ${rewardDisplay}
                    
                    <div class="validator-input-group">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--night-blue);">
                            Nom du superviseur:
                        </label>
                        <input type="text" id="validator_${activeMission.id}" class="validator-input" 
                               placeholder="Ex: Kazekage, Sensei Kaede...">
                    </div>
                    
                    <div class="validation-section">
                        <strong style="color: var(--night-blue);">Valider la Mission:</strong>
                        <div class="validation-buttons">
                            <button class="validate-btn validate-success" onclick="validateMission(${activeMission.id}, 'success')">
                                ‚úì R√©ussie
                            </button>
                            <button class="validate-btn validate-fail" onclick="validateMission(${activeMission.id}, 'failed')">
                                ‚úó √âchou√©e
                            </button>
                        </div>
                    </div>
                    
                    <div class="mission-details" style="margin-top: 1rem;">
                        <div class="mission-duration">‚è± ${activeMission.mission.duration}</div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Validate mission
        function validateMission(id, status) {
            const activeMissionIndex = activeMissions.findIndex(m => m.id === id);
            if (activeMissionIndex === -1) return;

            const activeMission = activeMissions[activeMissionIndex];
            const validatorInput = document.getElementById(`validator_${id}`);
            const supervisorName = validatorInput ? validatorInput.value.trim() : '';
            
            const statusText = status === 'success' ? 'r√©ussie' : '√©chou√©e';
            if (!confirm(`Confirmer que la mission "${activeMission.mission.title}" est ${statusText}?`)) {
                return;
            }

            // Move to completed
            completedMissions.push({
                ...activeMission,
                status: status,
                supervisedBy: supervisorName || 'Non sp√©cifi√©',
                completedDate: new Date().toISOString()
            });
            
            // Remove from active
            activeMissions.splice(activeMissionIndex, 1);
            
            // Save
            saveData(STORAGE_KEYS.ACTIVE_MISSIONS, activeMissions);
            saveData(STORAGE_KEYS.COMPLETED_MISSIONS, completedMissions);
            
            // Update UI
            updateStats();
            renderValidation();
            renderRecap();
            renderMissions('all');
            
            alert(`Mission "${activeMission.mission.title}" valid√©e comme ${statusText}!`);
        }

        // Delete from recap
        function deleteFromRecap(id) {
            const completedMission = completedMissions.find(m => m.id === id);
            if (!completedMission) return;
            
            if (!confirm(`Supprimer "${completedMission.mission.title}" du r√©capitulatif?\n\nCette action est irr√©versible.`)) {
                return;
            }
            
            completedMissions = completedMissions.filter(m => m.id !== id);
            saveData(STORAGE_KEYS.COMPLETED_MISSIONS, completedMissions);
            
            updateStats();
            renderRecap();
            
            alert('Mission supprim√©e du r√©capitulatif.');
        }

        // Render recap cards view
        function renderRecapCards() {
            const container = document.getElementById('recapCardsView');
            
            if (completedMissions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--night-blue);">
                        <h2 style="font-family: 'Cinzel', serif; margin-bottom: 1rem;">Aucune Mission Compl√©t√©e</h2>
                        <p>Les missions compl√©t√©es appara√Ætront ici.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = '';
            
            // Sort by completion date (most recent first)
            const sortedMissions = [...completedMissions].sort((a, b) => 
                new Date(b.completedDate) - new Date(a.completedDate)
            );
            
            sortedMissions.forEach(completed => {
                const card = document.createElement('div');
                card.className = 'recap-card';
                
                const completedDate = new Date(completed.completedDate);
                const dateStr = completedDate.toLocaleDateString('fr-FR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                let rewardDisplay = '';
                if (completed.status === 'success') {
                    if (completed.mission.reward > 0) {
                        rewardDisplay += `${completed.mission.reward.toLocaleString()} <span class="besant"></span>`;
                    }
                    if (completed.mission.resources) {
                        if (rewardDisplay) rewardDisplay += ' + ';
                        rewardDisplay += `üì¶ ${completed.mission.resources}`;
                    }
                    if (!rewardDisplay) rewardDisplay = 'Aucune';
                } else {
                    rewardDisplay = 'Aucune (mission √©chou√©e)';
                }

                card.innerHTML = `
                    <div class="recap-header">
                        <div class="recap-title">${completed.mission.title}</div>
                        <div class="recap-status ${completed.status === 'success' ? 'completed-badge success' : 'completed-badge failed'}">
                            ${completed.status === 'success' ? '‚úì' : '‚úó'}
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <strong>Rang:</strong> ${completed.mission.rank}
                        </div>
                        <div>
                            <strong>Type:</strong> ${completed.mission.type}
                        </div>
                        <div>
                            <strong>Dur√©e:</strong> ${completed.mission.duration}
                        </div>
                        <div>
                            <strong>R√©compenses:</strong> ${rewardDisplay}
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 1rem;">
                        <strong>Participants:</strong><br>
                        ${completed.participants.map(p => `<span class="participant-tag">${p}</span>`).join('')}
                    </div>
                    
                    ${completed.supervisedBy ? `<div class="validator-display">Supervis√© par: ${completed.supervisedBy}</div>` : ''}
                    
                    <div style="padding-top: 1rem; border-top: 2px solid var(--sand-mid); color: #666; font-size: 0.9rem; display: flex; justify-content: space-between; align-items: center;">
                        <span>Compl√©t√©e le ${dateStr}</span>
                        <button class="delete-recap-btn" onclick="deleteFromRecap(${completed.id})">üóëÔ∏è Effacer</button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Render recap table view
        function renderRecapTable() {
            const container = document.getElementById('recapTableView');
            
            if (completedMissions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--night-blue);">
                        <h2 style="font-family: 'Cinzel', serif; margin-bottom: 1rem;">Aucune Mission Compl√©t√©e</h2>
                        <p>Les missions compl√©t√©es appara√Ætront ici.</p>
                    </div>
                `;
                return;
            }
            
            // Sort by completion date (most recent first)
            const sortedMissions = [...completedMissions].sort((a, b) => 
                new Date(b.completedDate) - new Date(a.completedDate)
            );
            
            let tableHTML = `
                <div class="recap-table-container">
                    <table class="recap-table">
                        <thead>
                            <tr>
                                <th>Mission</th>
                                <th>Rang</th>
                                <th>Type</th>
                                <th>Participants</th>
                                <th>R√©compenses</th>
                                <th>Supervis√© par</th>
                                <th>Statut</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            sortedMissions.forEach(completed => {
                const completedDate = new Date(completed.completedDate);
                const dateStr = completedDate.toLocaleDateString('fr-FR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                let rewardDisplay = '';
                if (completed.status === 'success') {
                    const parts = [];
                    if (completed.mission.reward > 0) {
                        parts.push(`${completed.mission.reward.toLocaleString()} <span class="besant"></span>`);
                    }
                    if (completed.mission.resources) {
                        parts.push(`üì¶ ${completed.mission.resources}`);
                    }
                    rewardDisplay = parts.length > 0 ? parts.join('<br>') : 'Aucune';
                } else {
                    rewardDisplay = '-';
                }
                
                const statusClass = completed.status === 'success' ? 'status-success' : 'status-failed';
                const statusText = completed.status === 'success' ? '‚úì' : '‚úó';
                
                tableHTML += `
                    <tr>
                        <td><strong>${completed.mission.title}</strong></td>
                        <td><div class="rank-badge rank-${completed.mission.rank}" data-rank="${completed.mission.rank}" style="position: static; width: 40px; height: 40px; font-size: 0.8rem;"></div></td>
                        <td>${completed.mission.type}</td>
                        <td>${completed.participants.join(', ')}</td>
                        <td>${rewardDisplay}</td>
                        <td style="font-size: 0.85rem; font-style: italic;">${completed.supervisedBy || '-'}</td>
                        <td class="status-cell ${statusClass}" style="font-size: 1.5rem;">${statusText}</td>
                        <td style="white-space: nowrap; font-size: 0.85rem;">${dateStr}</td>
                        <td><button class="delete-recap-btn" onclick="deleteFromRecap(${completed.id})">üóëÔ∏è</button></td>
                    </tr>
                `;
            });
            
            tableHTML += `
                        </tbody>
                    </table>
                </div>
            `;
            
            container.innerHTML = tableHTML;
        }

        // Wrapper function for compatibility
        function renderRecap() {
            if (currentRecapView === 'cards') {
                renderRecapCards();
            } else {
                renderRecapTable();
            }
        }

        // Show mission details
        function showMissionDetails(mission) {
            const modal = document.getElementById('missionModal');
            document.getElementById('modalTitle').textContent = mission.title;
            
            let rewardText = '';
            if (mission.reward > 0) {
                rewardText = `<p style="margin-bottom: 1rem;"><strong>R√©compense:</strong> ${mission.reward.toLocaleString()} <span class="besant"></span></p>`;
            }
            if (mission.resources) {
                rewardText += `<p style="margin-bottom: 1rem;"><strong>Ressources:</strong> üì¶ ${mission.resources}</p>`;
            }
            
            document.getElementById('modalBody').innerHTML = `
                <div style="margin: 1.5rem 0;">
                    <p style="margin-bottom: 1rem;"><strong>Rang:</strong> ${mission.rank}</p>
                    <p style="margin-bottom: 1rem;"><strong>Type:</strong> ${mission.type}</p>
                    <p style="margin-bottom: 1rem;"><strong>Description:</strong><br>${mission.description}</p>
                    <p style="margin-bottom: 1rem;"><strong>D√©tails:</strong><br>${mission.details}</p>
                    ${rewardText}
                    <p style="margin-bottom: 1rem;"><strong>Dur√©e estim√©e:</strong> ${mission.duration}</p>
                    <button class="accept-btn" style="width: 100%; margin-top: 1rem; padding: 1rem;" onclick="acceptMission(${mission.id}); closeModal();">
                        Accepter la Mission
                    </button>
                </div>
            `;
            modal.classList.add('active');
        }

        // Close modal
        function closeModal() {
            document.getElementById('missionModal').classList.remove('active');
        }

        // Close modal on outside click
        document.getElementById('missionModal').addEventListener('click', (e) => {
            if (e.target.id === 'missionModal') {
                closeModal();
            }
        });

        // Initialize on load
        init();
    </script>
</body>
</html>